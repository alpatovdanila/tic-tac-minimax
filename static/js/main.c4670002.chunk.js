(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{10:function(e,t,n){e.exports=n(15)},15:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n.n(i),s=n(6),r=n.n(s),o=n(1);n(5);class c{constructor({width:e=3,height:t=3,stones:n},i){this.width=e,this.height=t,this.stones=n||new Array(e*t).fill(null),this.prevState=i,this.validMoves=this.stones.reduce((e,t,n)=>(t||e.push(n),e),[]),this.hash=this.stones.map((e,t)=>{return e?e.name:"\u2014"}).join("")}toJSON(){return{width:this.width,height:this.height,hash:this.hash,prevState:this.prevState}}next(e){return new this.constructor(Object.assign({width:this.width,height:this.height,stones:this.stones},e),this)}clear(){return this.next({stones:void 0},null)}addStone(e,t){const n=[...this.stones];return n[e]=t,this.next({stones:n})}}var h=n(7);var l=n(9);const m=e=>{let t=e.children,n=Object(l.a)(e,["children"]);return a.a.createElement("div",Object.assign({className:"board__cell"},n),t)},d=({children:e})=>a.a.createElement("div",{className:"board__row"},e),u=({state:e,onCellClick:t,terminal:n})=>{const i=e.width,s=e.height,r=e.stones;return a.a.createElement("div",{className:"board ".concat(n?" board_terminal":"")},Array.from({length:s},(e,t)=>t).map(e=>a.a.createElement(d,{key:e},Array.from({length:i},(e,t)=>t).map(n=>a.a.createElement(m,{key:n,onClick:()=>t(e*i+n)},r[e*i+n]?r[e*i+n].component:null)))))},g=({winner:e,onClose:t,enter:n})=>a.a.createElement("div",{className:"alert ".concat(n?"alert_enter":""),onClick:t},e&&a.a.createElement(a.a.Fragment,null,e.name," won!")),w=({onClose:e,enter:t})=>a.a.createElement("div",{className:"alert ".concat(t?"alert_enter":""),onClick:e},"That's a draw!"),f=({scores:e})=>{const t=Object(o.a)(e,2),n=t[0],i=t[1];return a.a.createElement("div",{className:"scores"},Array.from({length:n},(e,t)=>t).map(e=>a.a.createElement("div",{className:"scores__score scores__score_x",key:e})),Array.from({length:i},(e,t)=>t).map(e=>a.a.createElement("div",{className:"scores__score scores__score_o",key:e})))};var x=n(8);const C=({solver:e})=>{return a.a.createElement("div",{style:{color:"white",position:"absolute",top:0,left:0,padding:"25px",border:"1px solid red"}},"minimax cache length: ",Object.keys(e.minimaxCache).length,a.a.createElement("br",null),a.a.createElement("button",{onClick:()=>{const t=JSON.stringify(e.minimaxCache),n=new Blob([t],{type:"text/plain;charset=utf-8"});Object(x.saveAs)(n,"minimax-cache.json")}},"Download minimax cache"))},v=new class{constructor(){this.minimaxCache={},this.winConditionCache={}}indexRight(e,t){if(t%e.width<e.width-1)return t+1}indexLeft(e,t){if(t%e.width>0)return t-1}indexBelow(e,t){if(Math.floor(t/e.width)<e.height)return t+e.width}indexBelowRight(e,t){const n=this.indexBelow(e,t);if(n)return this.indexRight(e,n)}indexBelowLeft(e,t){const n=this.indexBelow(e,t);if(n)return this.indexLeft(e,n)}getSequence(e,t,n,i){const a=e.stones[t];if(!a||a!==n)return[];const s=(t=>"h"===i?this.indexRight(e,t):"v"===i?this.indexBelow(e,t):"dr"===i?this.indexBelowRight(e,t):"dl"===i?this.indexBelowLeft(e,t):void 0)(t);return s?[t,...this.getSequence(e,s,n,i)]:[t]}isWinCondition(e,t,n){for(let i=0;i<e.stones.length;i++){const a=e.stones[i];if(a&&a===t&&(this.getSequence(e,i,t,"h").length>=n||this.getSequence(e,i,t,"v").length>=n||this.getSequence(e,i,t,"dr").length>=n||this.getSequence(e,i,t,"dl").length>=n))return!0}return!1}minimax(e,t,n,i,a=3,s=!0,r=-1/0,o=1/0){const c=this.minimaxCache[e.hash];if(c){if(s&&c[0])return c[0];if(!s&&c[1])return c[1]}if(this.isWinCondition(e,t,i))return{score:100-a+Math.random()};if(this.isWinCondition(e,n,i))return{score:-100+a-Math.random()};if(0===e.validMoves.length)return{score:0+Math.random()};if(0===a)return{score:0+Math.random(),inFogOfWar:!0};let l=r,m=o,d={score:-1/0,cellIndex:-1},u={score:1/0,cellIndex:-1};var g,w=Object(h.a)(e.validMoves);try{for(w.s();!(g=w.n()).done;){let r=g.value;const o=e.addStone(r,s?t:n),c=this.minimax(o,t,n,i,a-1,!s,l,m);if(c.score>d.score&&(d={score:c.score,cellIndex:r,inFogOfWar:c.inFogOfWar}),c.score<u.score&&(u={score:c.score,cellIndex:r,inFogOfWar:c.inFogOfWar}),s&&m<=(l=Math.max(l,d.score)))break;if(!s&&(m=Math.min(m,u.score))<=l)break}}catch(f){w.e(f)}finally{w.f()}return this.minimaxCache[e.hash]||(this.minimaxCache[e.hash]=[]),d.inFogOfWar||(this.minimaxCache[e.hash][0]=d),u.inFogOfWar||(this.minimaxCache[e.hash][1]=u),s?d:u}},p=({width:e,height:t,winSequenceLength:n,minimaxDepth:s,playerType:r,enemyType:h,debug:l=!1})=>{const m=Object(i.useState)(new c({width:e,height:t})),d=Object(o.a)(m,2),x=d[0],p=d[1],b=Object(i.useState)([0,0]),O=Object(o.a)(b,2),E=O[0],j=O[1],y=Object(i.useState)(!1),S=Object(o.a)(y,2),_=S[0],M=S[1],k=Object(i.useMemo)(()=>v.isWinCondition(x,r,n)?r:v.isWinCondition(x,h,n)?h:null),L=Object(i.useMemo)(()=>!k&&0===x.validMoves.length,[k,x.validMoves.length]),B=Object(i.useMemo)(()=>!(!k&&!L),[k,L]),N=()=>{k===r&&j([E[0]+1,E[1]]),k===h&&j([E[0],E[1]+1]),p(x.clear())};return a.a.createElement(a.a.Fragment,null,l&&a.a.createElement(C,{solver:v}),a.a.createElement(f,{scores:E}),a.a.createElement(u,{state:x,onCellClick:e=>{if(!x.stones[e]&&!B&&!_){const t=x.addStone(e,r);p(t),M(!0);const i=v.minimax(t,h,r,n,s);p(t.addStone(i.cellIndex,h)),M(!1)}},terminal:B}),a.a.createElement(g,{winner:k,onClose:N,enter:k}),a.a.createElement(w,{onClose:N,enter:L}))},b=()=>{const e=Object(i.useState)(!1),t=Object(o.a)(e,2),n=t[0],s=t[1];return Object(i.useEffect)(()=>{s(!0)},[]),a.a.createElement("svg",{width:"72",height:"72",viewBox:"-4 -4 80 80",xmlns:"http://www.w3.org/2000/svg",className:"stone stone_x ".concat(n?" stone_enter":"")},a.a.createElement("path",{d:"M1.17157 69.0538C2.73367 70.6159 5.26633 70.6159 6.82843 69.0538L69.0538 6.82843C70.6159 5.26633 70.6159 2.73367 69.0538 1.17157C67.4917 -0.390522 64.9591 -0.390519 63.397 1.17158L1.17157 63.397C-0.390523 64.9591 -0.390523 67.4917 1.17157 69.0538ZM1.17157 6.82855C-0.390525 5.26645 -0.390525 2.73378 1.17157 1.17169C2.73367 -0.390407 5.26633 -0.390407 6.82843 1.17169L32.2842 26.6275L26.6274 32.2843L1.17157 6.82855ZM37.9411 43.598L43.5979 37.9412L69.0538 63.3971C70.6159 64.9592 70.6159 67.4918 69.0538 69.0539C67.4917 70.616 64.9591 70.616 63.397 69.0539L37.9411 43.598Z"}))},O=()=>{const e=Object(i.useState)(!1),t=Object(o.a)(e,2),n=t[0],s=t[1];return Object(i.useEffect)(()=>(s(!0),()=>{s(!1)}),[]),a.a.createElement("svg",{width:"80",height:"80",viewBox:"0 0 80 80",xmlns:"http://www.w3.org/2000/svg",className:"stone stone_o ".concat(n?" stone_enter":"")},a.a.createElement("path",{d:"M40 0C62.0914 0 80 17.9086 80 40C80 57.5969 68.6371 72.5399 52.8484 77.8918C50.3893 78.7253 48 76.772 48 74.1756V74.1756C48 72.3017 49.2802 70.6913 51.0391 70.0449C63.2729 65.5485 72 53.7934 72 40C72 22.3269 57.6731 8 40 8C22.3269 8 8.00001 22.3269 8.00001 40C8.00001 53.7934 16.7271 65.5485 28.9609 70.0449C30.7198 70.6913 32 72.3017 32 74.1756V74.1756C32 76.772 29.6107 78.7254 27.1516 77.8918C11.3629 72.5399 -2.16192e-06 57.5969 0 40C0 17.9086 17.9086 -2.7141e-06 40 0Z"}))},E={component:a.a.createElement(O,null),name:"O"},j={component:a.a.createElement(b,null),name:"X"},y=document.getElementById("game");r.a.render(a.a.createElement(p,{width:3,height:3,winSequenceLength:3,minimaxDepth:7,playerType:E,enemyType:j}),y)},5:function(e,t,n){}},[[10,1,2]]]);
//# sourceMappingURL=main.c4670002.chunk.js.map